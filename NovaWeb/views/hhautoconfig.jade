extends layout

block headerAdditions
  script
    function validateAndAdd(id, errLabel)
    {
      var toValidate = document.getElementById(id).value;
    
      var regex = new RegExp("^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\/[1-3]?[0-9]$");
    
      if(toValidate[toValidate.length - 2] == "3" && toValidate[toValidate.length - 1] > 2)
      {
        document.getElementById(errLabel).innerHTML = "Invalid subnet bit value (e.g. 33 or higher)";
        return;
      }
    
      if(regex.test(toValidate))
      {
        document.getElementById(errLabel).innerHTML = "Valid subnet found!";
        // add here
      }
      else
      {
        document.getElementById(errLabel).innerHTML = "That is not a valid subnet.";
        return;
      }
    }
  
    function watermark(id, text)
    {
      var element = document.getElementById(id);
    
      if(element.value.length > 0)
      {
        if(element.value == text)
        {
          element.value = '';
        }
      }
      else
      {
        element.value = text;
      }
    }
    
    function checkIntMax(id)
    {
      if(document.getElementById(id).value > 511)
      {
        document.getElementById(id).value = 511;
      }
      return;
    }

block content

  h2 Haystack Autoconfig
  form(method="post", action="/scanning")
    label Number of Haystack Nodes to create: 
    input(type="number", name="numNodes", id="numNodes", width="4", min="0", max="511", onblur="checkIntMax(\"numNodes\")", value="0")
    br
    br
    label(id="errorLabel", style="color:red;")
    br
    label Additional Subnets to scan:
    input(type="text", id="subnetToAdd", width="20", onblur="watermark(\"subnetToAdd\", \"Format: XXX.XXX.XXX.0/##\");", onfocus="watermark(\"subnetToAdd\", \"Format: XXX.XXX.XXX.0/##\");", value="Format: XXX.XXX.XXX.0/##") 
    button(type="button", style="width:160px", onclick="validateAndAdd(\"subnetToAdd\", \"errorLabel\");") Add Subnet
    br
    br
    input(type="submit", id="startScan", value="Start Scanning")
  
